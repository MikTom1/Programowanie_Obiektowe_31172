
@page "/"
@page "/Login"
@using MudBlazor

@using BlazorApp1.Services
@inject NavigationManager Nav
@inject ISnackbar Snackbar
@inject AuthService Auth
@rendermode InteractiveServer


<MudContainer MaxWidth="MaxWidth.ExtraSmall" Class="mt-12">
    <MudPaper Elevation="12" Class="pa-6" Style="width:400px">
        <MudText Typo="Typo.h5" Class="mb-4">Logowanie</MudText>
    
        <MudForm @ref="form">
            <MudTextField Label="Login" 
                          ShrinkLabel="true"
                          @bind-Value="login"
                          Required="true"
                          Class="mb-3"
                          RequiredError="Podaj login"/>

       
            <MudTextField Label="Password" 
                          ShrinkLabel="true"
                          @bind-Value="password"
                          Required="true"
                          Class="mb-4"
                          InputType="InputType.Password"
                          RequiredError="Podaj haslo"/>

        </MudForm> 
        <MudButton Variant="Variant.Filled" Color="Color.Primary" Style="width: 100px" OnClick="@(DoLogin)"
                   Disabled="@busy" ButtonType="ButtonType.Button">Login</MudButton>
    </MudPaper>
</MudContainer>





@code {
    private MudForm form;
    private string login;
    private string password;
    private bool busy=false;

    private async Task DoLogin()
    {
        
        bool log = Auth.Login(login, password);
        if (log)
        {
            Snackbar.Add("Zalogowano pomyslnie",Severity.Success);
            Nav.NavigateTo("/Users");
            
        }
        else
        
            {
                Snackbar.Add("Bledne dane logowania",Severity.Error);
            }
        
    }


}